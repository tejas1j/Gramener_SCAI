# Generated by gramex init 1.56.0 (don't delete this line)
# on 2019-08-08 by Author <user@example.org>

# Configurations for app: demo
# ----------------------------------------------------------------------------
url:
  demo-home:
    pattern: /$YAMLURL/
    handler: FileHandler
    kwargs:
      path: $YAMLPATH/index.html
      # See https://learn.gramener.com/guide/auth/#authorization for auth rules
      auth: true
      template: true
      headers:
        # Templates may have user-specific content. Cache privately.
        # Keep max-age small (in case we log out & log in as another user.)
        Cache-Control: private, max-age=1
    cache: {expiry: {duration: 1}}

  ppt-scraping:
    pattern: /$YAMLURL/ppt-scrap
    handler: FunctionHandler
    kwargs:
      function: dd_scraping.scrap_data()  


  pptxhandler/ppt:
    pattern: /$YAMLURL/ppt-sample
    handler: PPTXHandler
    kwargs:

      source: Input_PPT_v1.pptx

      

      data:
        table_data1: {url: $YAMLURL/Revenue.xlsx , sheetname: Sheet1} #3,4,20,21
        table_data2: {url: $YAMLURL/Services_Revenue_exc_Vbr.xlsx , sheetname: Sheet1} #5,22
        table_data3: {url: $YAMLURL/Support_services_excl_VBR.xlsx , sheetname: Sheet1} #6
        table_data4: {url: $YAMLURL/GP.xlsx , sheetname: Sheet1} #8,9,23
        table_data5: {url: $YAMLURL/GM.xlsx , sheetname: Sheet1} #10,11,24
        table_data6: {url: $YAMLURL/Annuity Revenue.xlsx , sheetname: Sheet1} #7
        table_data7: {url: $YAMLURL/Services GM exc_VBR.xlsx , sheetname: Sheet1} #12
        table_data8: {url: $YAMLURL/Budget Ach Regions.xlsx , sheetname: Sheet1} #14
        # table_data9: {url: $YAMLURL/Budget Gaps Regions in Millions.xlsx , sheetname: Sheet1} #15
        # table_data10: {url: $YAMLURL/YOY % Growth Regions.xlsx , sheetname: Sheet1} #16
        # table_data11: {url: $YAMLURL/YOY Growth Regions in Millions.xlsx , sheetname: Sheet1} #17
        # table_data12: {url: $YAMLURL/Central Services.xlsx , sheetname: Sheet1} #25,26
        # table_data13: {url: $YAMLURL/OrderBooking.xlsx , sheetname: Sheet1} #29,30
        # table_data14: {url: $YAMLURL/ACV.xlsx , sheetname: Sheet1} #31
        # table_data15: {url: $YAMLURL/Services ACV.xlsx , sheetname: Sheet1} #32
        # table_data16: {url: $YAMLURL/Services Revenue.xlsx , sheetname: Sheet1} #37,40
        # table_data17: {url: $YAMLURL/ServicesMRR.xlsx , sheetname: Sheet1} #37,40
        # # table_data3: {url: $YAMLURL/Revenue.xlsx , sheetname: Sheet1}
        # # table_data1: {url: $YAMLURL/Revenue.csv}
        annote1: { function: annotations.annote('slide_1')}
      # change-text:
      #   #SLide 5
      #   # data: data['table_data']
      #   # Title 1:
      #   #   text: "{{ table_data['Slide Title'][0] }}"
      #   Subtitle 1:
      #     text: "DD Services Revenue growth <text bold='True'>{{annote1[0]}} ({{annote1[1]}}%YoY)</text>;<text color='#228B22' bold='True'> {{annote1[2]}} out of 5 </text> regions <text color='#228B22' bold='True'>growing </text> while <text color='#FF0000' bold='True'>{{annote1[3]}}</text> is <text bold='True'>declining</text>" 
      #     # style:
      #     #   color: "#ffff"
      #     #"New Title <text color='#00ff00' bold='True'> Colored Bold Text </text>"
      #     #'DD Services Revenue growth' + "{{annote1[0]}}"+" behind ("+str(x)+"% YoY); "+ str(c) +" out of 5 regions growing while"+"\n"+string+" is declining"
      #   insightvalues1:
      #     text:  "{{ table_data['YoY%'][0] }}%"
      #     style:
      #       color: 
      #         function: annotations.color(data['table_data']['YoY%'][0], 'insights')
              
      #       bold: True
      #   insightvalues2:
      #     text:  "{{ table_data['YoY%'][2] }}%"
      #     style:
      #       color: 
      #         function: annotations.color(data['table_data']['YoY%'][2], 'insights')
      #       bold: True
      #   insightvalues3:
      #     text:  "{{ table_data['YoY%'][6] }}%"    
      #     style:
      #       color: 
      #         function: annotations.color(data['table_data']['YoY%'][6], 'insights')
      #       bold: True   
      # #   #slide 4

      edit-table: 
        #slide 3
        Table_sheet3:
          table:
            data:
              function: PPT_gen.percentage_convert(data['table_data1'].head(3)[["Financial HighLights","Q2 FY18","Q2 FY19","YoY%","Ach%","Bgt Gap","PF Gap"]]).append(data['table_data1'].tail(1)[["Financial HighLights","Q2 FY18","Q2 FY19","YoY%","Ach%","Bgt Gap","PF Gap"]])
            style:                    # Common CSS for all the cells
              font-size: 16
              text-align: center
              color: "#7f7f7f" 
              margin: 5
  
        #slide4
        Table_sheet4:
          table:
            data:
              function: PPT_gen.percentage_convert(data['table_data1'][["Financial HighLights","Q2 FY18","Q2 FY19","YoY%","Ach%","Bgt Gap","PF Gap"]])
            style:                    # Common CSS for all the cells
              font-size: 16
              text-align: center
              color: "#7f7f7f" 
              margin: 5
        #Slide 5              
        Table_sheet5:
          table:
            data: 
              function: PPT_gen.percentage_convert(data['table_data2'].head(8)[["_--_Services_Revenue_(Excl_VBR)","Q2 FY18","Q2 FY19","YoY%","Ach%","Bgt Gap","PF Gap"]])
            style:                    # Common CSS for all the cells
              font-size: 16
              text-align: center
              color: "#7f7f7f" 
              margin: 5
            
  
        #Slide 6    
        Table_sheet6:
          table:
            data: 
              function: PPT_gen.percentage_convert(data['table_data3'].head(8)[["_---_Support_Services(Excl_VBR)","Q2 FY18","Q2 FY19","YoY%","Ach%","Bgt Gap","PF Gap"]])
            style:                    # Common CSS for all the cells
              font-size: 16
              text-align: center
              color: "#7f7f7f" 
              margin: 5
        #slide7
        Table_sheet7:
          table:
            data:
              function: PPT_gen.percentage_convert(data['table_data6'])   
            style:                    # Common CSS for all the cells
              font-size: 16 
              color: "#7f7f7f" 
              margin: 5

        #slide8
        Table_sheet8:
          table:
            data:
              function: PPT_gen.percentage_convert(data['table_data4'].head(9)[["Financial HighLights","Q2 FY18","Q2 FY19","YoY%","Ach%","Bgt Gap","PF Gap"]])
            style:                    # Common CSS for all the cells
              font-size: 16
              text-align: center
              color: "#7f7f7f" 
              margin: 5

        #slide9
        Table_sheet9:
          table:
            data:
              function: PPT_gen.percentage_convert(data['table_data4'][["Financial HighLights","Q2 FY18","Q2 FY19","YoY%","Ach%","Bgt Gap","PF Gap"]])
            style:                    # Common CSS for all the cells
              font-size: 16
              text-align: center
              color: "#7f7f7f" 
              margin: 5

        #slide10
        Table_sheet10:
          table:
            data:
              function: PPT_gen.percentage_convert(data['table_data5'].head(4)[["Financial HighLights","Q2 FY18","Q2 FY19","YoY%","Ach%","Bgt Gap","PF Gap"]]).append(data['table_data5'].tail(1)[["Financial HighLights","Q2 FY18","Q2 FY19","YoY%","Ach%","Bgt Gap","PF Gap"]])
            style:                    # Common CSS for all the cells
              font-size: 16
              text-align: center
              color: "#7f7f7f" 
              margin: 5
        #slide11
        Table_sheet11:
           table:
            data:
              function: PPT_gen.percentage_convert(data['table_data5'].head(9)[["Financial HighLights","Q2 FY18","Q2 FY19","YoY%","Ach%","Bgt Gap","PF Gap"]])
            style:                    # Common CSS for all the cells
              font-size: 16
              text-align: center
              color: "#7f7f7f" 
              margin: 5
        #slide12
        Table_sheet12:
          table:
            data: 
              function: PPT_gen.percentage_convert(data['table_data7'].head(8)[["services GM excl VBR","Q2 FY18","Q2 FY19","YoY%","Ach%","Bgt Gap","PF Gap"]])
            style:                    # Common CSS for all the cells
              font-size: 16
              text-align: center
              color: "#7f7f7f" 
              margin: 5
        #slide14
        Table_sheet14:
          table:
            data: 
              function: PPT_gen.percentage_convert(data['table_data8'].head(4)[["Services Scorecard",	"Group"	,"MEA","EU"	,"AP",	"AU",	"AM","Central Services"]])
            style:                    # Common CSS for all the cells
              font-size: 16
              text-align: center
              color: "#7f7f7f" 
              margin: 5
        
        #slide15
        Table_sheet15:
          table:
            data:
              function:
        #slide16
        Table_sheet16:
          table:
            data:
              function:
        
        #slide17
        Table_sheet17:
          table:
            data:
              function:
              
        #slide18
        Table_sheet18:
          table:
            data:
              function:

        #slide20
        Table_sheet20:
          table:
            data:
              function:
        
        #slide21
        Table_sheet21:
          table:
            data:
              function:

        #slide22
        Table_sheet22:
          table:
            data:
              function:
        
        #slide23
        Table_sheet23:
          table:
            data:
              function:
        
        #slide24
        Table_sheet24:
          table:
            data:
              function:
        
        #slide25
        Table_sheet25:
          table:
            data:
              function:
        
        #slide26
        Table_sheet26:
          table:
            data:
              function:

        #slide29
        Table_sheet29:
          table:
            data:
              function:
        
        #slide30
        Table_sheet30:
          table:
            data:
              function:
        
        #slide31
        Table_sheet31:
          table:
            data:
              function:
        
        #slide32
        Table_sheet32:
          table:
            data:
              function:
        
        #slide37
        Table_sheet37:
          table:
            data:
              function:

        #slide40
        Table_sheet40:
          table:
            data:
              function:
      change-image:
        picture27:
          image: $YAMLPATH/slide27.png
        picture28:
          image: $YAMLPATH/slide28.png
        picture33:
          image: $YAMLPATH/slide33.png
        picture34:
          image: $YAMLPATH/slide34.png
        picture36:
          image: $YAMLPATH/slide36.png
        picture38:
          image: $YAMLPATH/slide38.png
        picture39:
          image: $YAMLPATH/slide39.png
        picture41:
          image: $YAMLPATH/slide41.png
      headers:
        Content-Disposition: attachment; filename=output.pptx  

  demo-login:
    # Default login_url is /login/. If you change this, change auth.login_url
    # https://learn.gramener.com/guide/auth/#login-urls
    pattern: /$YAMLURL/login/
    # You MUST change the auth before deploying. DBAuth is commonly used.
    # See https://learn.gramener.com/guide/auth/#database-auth
    handler: SimpleAuth
    kwargs:
      template: $YAMLPATH/login.html
      credentials:
        alpha: alpha
        beta: beta

  demo-logout:
    pattern: /$YAMLURL/logout/
    handler: LogoutHandler





# Gramex init configurations for app: demo
# ----------------------------------------------------------------------------
import:
  # To secure application for production,
  # replace 'YOUR-PROD-SERVER-NAME' with your production server host name.
  deploy if socket.gethostname() in {'YOUR-PROD-SERVER-NAME'}: $GRAMEXPATH/deploy.yaml
  # For alternate methods, see https://learn.gramener.com/guide/config/#conditions

  # /ui/ has Gramex UI components -- use this like the node_modules/ directory
  ui:
    path: $GRAMEXAPPS/ui/gramex.yaml
    YAMLURL: $YAMLURL/ui/

  # /admin/ as an admin page to manage users, get system info, etc.
  admin:
    path: $GRAMEXAPPS/admin2/gramex.yaml    # Note the "admin2" instead of "admin"
    YAMLURL: /$YAMLURL/admin/               # URL to show the admin page at
    ADMIN_KWARGS:
      logo: https://gramener.com/uistatic/gramener.png
      home: /$YAMLURL/
      title: Admin
      theme: '?body-bg=white&navbar-dark-color=rgba(255%2C255%2C255%2C.8)&navbar-dark-hover-color=white'
      # authhandler: name-of-DBAuth-handler    -- required for user management
    ADMIN_AUTH:
      membership:
        hd: gramener.com                    # Only @gramener.com Google Auth are admins

handlers:
  BaseHandler:
    # Custom error pages for this application
    error:
      400: {path: $YAMLPATH/error/400.html}     # Bad request: e.g. URL argument missing
      401: {path: $YAMLPATH/error/401.html}     # Unauthorized: User not logged in
      403: {path: $YAMLPATH/error/403.html}     # Forbidden: user does not have access
      404: {path: $YAMLPATH/error/404.html}     # File not found
      # 500: {path: $YAMLPATH/error/500.html}     # Internal server error
